{
  "permissions": {
    "allow": [
      "WebFetch(domain:arxiv.org)",
      "WebFetch(domain:github.com)",
      "WebFetch(domain:www.reddit.com)",
      "Bash(for dir in src src/data src/features src/features/indicators src/models src/execution src/evaluation src/utils)",
      "Bash(do touch:*)",
      "Bash(done)",
      "WebFetch(domain:www.quantconnect.com)",
      "Bash(python3 -c \"\nimport PyPDF2, os, glob\n\nbase = r''c:\\\\ML\\\\intra-trading-system-dynamic\\\\docs\\\\offline-articles''\npdfs = glob.glob\\(os.path.join\\(base, ''**'', ''*.pdf''\\), recursive=True\\)\n\nfor pdf_path in pdfs:\n    print\\(f''\\\\n{\"\"=\"\"*80}''\\)\n    print\\(f''FILE: {os.path.relpath\\(pdf_path, base\\)}''\\)\n    print\\(''=''*80\\)\n    try:\n        reader = PyPDF2.PdfReader\\(pdf_path\\)\n        print\\(f''Pages: {len\\(reader.pages\\)}''\\)\n        text = ''''\n        for i, page in enumerate\\(reader.pages\\):\n            t = page.extract_text\\(\\)\n            if t:\n                text += t + ''\\\\n''\n        # Print first 3000 chars of each\n        if text.strip\\(\\):\n            print\\(text[:3000]\\)\n            if len\\(text\\) > 3000:\n                print\\(f''\\\\n... [TRUNCATED - total {len\\(text\\)} chars]''\\)\n        else:\n            print\\(''[No extractable text - may be scanned/image PDF]''\\)\n    except Exception as e:\n        print\\(f''Error: {e}''\\)\n\")",
      "Bash(python3 -c \"\nimport PyPDF2, os, glob, sys\n\n# Fix encoding\nsys.stdout.reconfigure\\(encoding=''utf-8'', errors=''replace''\\)\n\nbase = r''c:\\\\ML\\\\intra-trading-system-dynamic\\\\docs\\\\offline-articles''\npdfs = glob.glob\\(os.path.join\\(base, ''**'', ''*.pdf''\\), recursive=True\\)\n\n# Read remaining PDFs that failed due to encoding\nfor pdf_path in pdfs:\n    relpath = os.path.relpath\\(pdf_path, base\\)\n    if ''Finance_GPT'' in relpath or ''market7'' in relpath:\n        continue  # Already read these\n    \n    print\\(f''\\\\n{\"\"=\"\"*80}''\\)\n    print\\(f''FILE: {relpath}''\\)\n    print\\(''=''*80\\)\n    try:\n        reader = PyPDF2.PdfReader\\(pdf_path\\)\n        print\\(f''Pages: {len\\(reader.pages\\)}''\\)\n        text = ''''\n        for i, page in enumerate\\(reader.pages\\):\n            t = page.extract_text\\(\\)\n            if t:\n                text += t + ''\\\\n''\n        if text.strip\\(\\):\n            print\\(text[:4000]\\)\n            if len\\(text\\) > 4000:\n                print\\(f''\\\\n... [TRUNCATED - total {len\\(text\\)} chars]''\\)\n        else:\n            print\\(''[No extractable text]''\\)\n    except Exception as e:\n        print\\(f''Error: {e}''\\)\n\")",
      "Bash(python3 -c \"\nimport PyPDF2, sys\nsys.stdout.reconfigure\\(encoding=''utf-8'', errors=''replace''\\)\n\nreader = PyPDF2.PdfReader\\(r''c:\\\\ML\\\\intra-trading-system-dynamic\\\\docs\\\\offline-articles\\\\Finance_GPT_Proposal.pdf''\\)\ntext = ''''\nfor page in reader.pages:\n    t = page.extract_text\\(\\)\n    if t: text += t + ''\\\\n''\nprint\\(text[:12000]\\)\n\")",
      "Bash(ls -la \"c:\\\\ML\\\\intra-trading-system-dynamic\\\\results_from_quant_connect\"\" 2>/dev/null || ls -la /mnt/c/ML/intra-trading-system-dynamic/results_from_quant_connect/ 2>/dev/null || dir \"c:MLintra-trading-system-dynamicresults_from_quant_connect\"\")",
      "Bash(python3 -c \"\nimport json, os, glob\n\nbase = ''c:/ML/intra-trading-system-dynamic/results_from_quant_connect/event-driven new refactor/experiment_17_2_2026_1440''\n\nfor period_dir in sorted\\(os.listdir\\(base\\)\\):\n    period_path = os.path.join\\(base, period_dir\\)\n    if not os.path.isdir\\(period_path\\):\n        continue\n    json_files = glob.glob\\(os.path.join\\(period_path, ''*.json''\\)\\)\n    if not json_files:\n        continue\n    with open\\(json_files[0], ''r''\\) as f:\n        data = json.load\\(f\\)\n    \n    stats = data.get\\(''statistics'', {}\\)\n    runtime = data.get\\(''runtimeStatistics'', {}\\)\n    total_perf = data.get\\(''totalPerformance'', {}\\)\n    trade_stats = total_perf.get\\(''tradeStatistics'', {}\\)\n    port_stats = total_perf.get\\(''portfolioStatistics'', {}\\)\n    \n    print\\(f''{''=''*70}''\\)\n    print\\(f''  Period: {period_dir}''\\)\n    print\\(f''  Name: {data.get\\(\"\"algorithmConfiguration\"\", {}\\).get\\(\"\"name\"\", \"\"?\"\"\\)}''\\)\n    print\\(f''{''=''*70}''\\)\n    print\\(f''  --- Core Stats ---''\\)\n    for k in [''Total Orders'', ''Compounding Annual Return'', ''Net Profit'', ''Sharpe Ratio'', \n              ''Sortino Ratio'', ''Probabilistic Sharpe Ratio'', ''Drawdown'',\n              ''Win Rate'', ''Loss Rate'', ''Average Win'', ''Average Loss'', \n              ''Profit-Loss Ratio'', ''Expectancy'', ''Alpha'', ''Beta'',\n              ''Annual Standard Deviation'', ''Information Ratio'']:\n        if k in stats:\n            print\\(f''    {k}: {stats[k]}''\\)\n    \n    print\\(f''  --- Runtime ---''\\)\n    for k in [''Equity'', ''Net Profit'', ''Return'', ''Fees'', ''Volume'']:\n        if k in runtime:\n            print\\(f''    {k}: {runtime[k]}''\\)\n    \n    print\\(f''  --- Trade Stats ---''\\)\n    for k in [''totalNumberOfTrades'', ''numberOfWinningTrades'', ''numberOfLosingTrades'',\n              ''averageTradeDuration'', ''medianTradeDuration'', ''maxConsecutiveWinningTrades'',\n              ''maxConsecutiveLosingTrades'', ''largestWin'', ''largestLoss'',\n              ''averageProfit'', ''averageLoss'', ''averageEndTradeDrawdown'',\n              ''maxEndTradeDrawdown'', ''totalFees'']:\n        if k in trade_stats:\n            print\\(f''    {k}: {trade_stats[k]}''\\)\n    \n    print\\(\\)\n\")",
      "Bash(python3 -c \"\nimport fitz, sys, io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding=''utf-8'', errors=''replace''\\)\n\nfor pdf_path in [''c:/ML/intra-trading-system-dynamic/docs/offline-articles/ssrn-3813202.pdf'', ''c:/ML/intra-trading-system-dynamic/docs/offline-articles/ssrn-2708678.pdf'']:\n    doc = fitz.open\\(pdf_path\\)\n    print\\(f''\\\\n{\"\"=\"\"*80}''\\)\n    print\\(f''FILE: {pdf_path}''\\)\n    print\\(f''Pages: {len\\(doc\\)}''\\)\n    print\\(f''{\"\"=\"\"*80}''\\)\n    for i in range\\(min\\(25, len\\(doc\\)\\)\\):\n        text = doc[i].get_text\\(\\)\n        print\\(f''\\\\n--- PAGE {i+1} ---''\\)\n        print\\(text[:2500]\\)\n\")",
      "Bash(python3 -c \"\nimport ast, sys\ntry:\n    with open\\(''strategies/trend_events/main.py'', ''r''\\) as f:\n        tree = ast.parse\\(f.read\\(\\)\\)\n    \n    # Check for class definition\n    classes = [node.name for node in ast.walk\\(tree\\) if isinstance\\(node, ast.ClassDef\\)]\n    functions = [node.name for node in ast.walk\\(tree\\) if isinstance\\(node, ast.FunctionDef\\)]\n    \n    print\\(f''Syntax: OK''\\)\n    print\\(f''Classes: {classes}''\\)\n    print\\(f''Functions: {functions}''\\)\n    print\\(f''Total lines: {len\\(open\\(\"\"strategies/trend_events/main.py\"\"\\).readlines\\(\\)\\)}''\\)\nexcept SyntaxError as e:\n    print\\(f''SYNTAX ERROR: {e}''\\)\n    sys.exit\\(1\\)\n\")",
      "Bash(python3 -c \"\nimport json, os, glob\n\nbase = ''c:/ML/intra-trading-system-dynamic/results_from_quant_connect/trade-events/experiment_18_2_2026_1800''\n\nprint\\(''=''*60\\)\nprint\\(''TREND+EVENTS v1 RESULTS \\(your latest run\\)''\\)\nprint\\(''=''*60\\)\n\nfor period_dir in sorted\\(os.listdir\\(base\\)\\):\n    period_path = os.path.join\\(base, period_dir\\)\n    if not os.path.isdir\\(period_path\\):\n        continue\n    json_files = glob.glob\\(os.path.join\\(period_path, ''*.json''\\)\\)\n    if not json_files:\n        continue\n    with open\\(json_files[0], ''r''\\) as f:\n        data = json.load\\(f\\)\n    s = data.get\\(''statistics'', {}\\)\n    r = data.get\\(''runtimeStatistics'', {}\\)\n    ts = data.get\\(''totalPerformance'', {}\\).get\\(''tradeStatistics'', {}\\)\n    \n    print\\(f''\\\\nPeriod: {period_dir}''\\)\n    for k in [''Total Orders'', ''Compounding Annual Return'', ''Net Profit'', ''Sharpe Ratio'',\n              ''Sortino Ratio'', ''Probabilistic Sharpe Ratio'', ''Drawdown'',\n              ''Win Rate'', ''Loss Rate'', ''Average Win'', ''Average Loss'',\n              ''Profit-Loss Ratio'', ''Expectancy'', ''Alpha'', ''Beta'',\n              ''Annual Standard Deviation'', ''Information Ratio'']:\n        if k in s:\n            print\\(f''  {k}: {s[k]}''\\)\n    print\\(f''  Trades: {ts.get\\(\"\"totalNumberOfTrades\"\", \"\"?\"\"\\)}''\\)\n    print\\(f''  Fees: {r.get\\(\"\"Fees\"\", \"\"?\"\"\\)}''\\)\n    print\\(f''  Equity: {r.get\\(\"\"Equity\"\", \"\"?\"\"\\)}''\\)\n\")",
      "Bash(python3 -c \"\nimport ast\nwith open\\(''c:/ML/intra-trading-system-dynamic/strategies/combined_dual/main.py'', ''r''\\) as f:\n    source = f.read\\(\\)\n    tree = ast.parse\\(source\\)\n\nclasses = [n.name for n in ast.walk\\(tree\\) if isinstance\\(n, ast.ClassDef\\)]\nfunctions = [n.name for n in ast.walk\\(tree\\) if isinstance\\(n, ast.FunctionDef\\)]\nlines = len\\(source.split\\(''\\\\n''\\)\\)\n\nprint\\(f''Syntax: OK''\\)\nprint\\(f''Class: {classes}''\\)\nprint\\(f''Methods: {functions}''\\)\nprint\\(f''Lines: {lines}''\\)\nprint\\(\\)\n\n# Check for common QC API issues\nissues = []\nif ''self.history\\('' in source:\n    print\\(''Note: Uses self.history\\(\\) — needs to handle MultiIndex DataFrame from QC''\\)\nif ''Resolution.DAILY'' in source:\n    print\\(''Note: Uses Resolution.DAILY — standard QC API''\\)\nif ''self.sma\\('' in source:\n    print\\(''Note: Uses self.sma\\(\\) with Resolution — standard QC helper''\\)\nif ''int\\('' in source and ''quantity'' in source.lower\\(\\):\n    print\\(''Note: Uses int\\(\\) for quantity — QC requires integer shares for equities''\\)\n\")",
      "Bash(python3 -c \"\nimport ast\nwith open\\(''c:/ML/intra-trading-system-dynamic/strategies/monthly_rotator/main.py'', ''r'', encoding=''utf-8''\\) as f:\n    source = f.read\\(\\)\n    tree = ast.parse\\(source\\)\nclasses = [n.name for n in ast.walk\\(tree\\) if isinstance\\(n, ast.ClassDef\\)]\nfunctions = [n.name for n in ast.walk\\(tree\\) if isinstance\\(n, ast.FunctionDef\\)]\nlines = len\\(source.split\\(''\\\\n''\\)\\)\nprint\\(f''Syntax: OK''\\)\nprint\\(f''Class: {classes}''\\)\nprint\\(f''Methods \\({len\\(functions\\)}\\): {functions}''\\)\nprint\\(f''Lines: {lines}''\\)\n\")",
      "Bash(python3 -c \"\nimport json, os, glob, sys, io\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding=''utf-8'', errors=''replace''\\)\n\nbase = ''c:/ML/intra-trading-system-dynamic/results_from_quant_connect/CombinedDualEngine/experiment_19_2_2026_1240''\n\nfor period_dir in sorted\\(os.listdir\\(base\\)\\):\n    pp = os.path.join\\(base, period_dir\\)\n    if not os.path.isdir\\(pp\\):\n        continue\n    jf = glob.glob\\(os.path.join\\(pp, ''*.json''\\)\\)\n    if not jf:\n        continue\n    with open\\(jf[0], ''r''\\) as f:\n        data = json.load\\(f\\)\n\n    s = data.get\\(''statistics'', {}\\)\n    r = data.get\\(''runtimeStatistics'', {}\\)\n    ts = data.get\\(''totalPerformance'', {}\\).get\\(''tradeStatistics'', {}\\)\n    ps = data.get\\(''totalPerformance'', {}\\).get\\(''portfolioStatistics'', {}\\)\n\n    print\\(f''{''=''*70}''\\)\n    print\\(f''  {period_dir} — {data.get\\(\"\"algorithmConfiguration\"\",{}\\).get\\(\"\"name\"\",\"\"?\"\"\\)}''\\)\n    print\\(f''{''=''*70}''\\)\n\n    for k in [''Total Orders'', ''Compounding Annual Return'', ''Net Profit'',\n              ''Sharpe Ratio'', ''Sortino Ratio'', ''Probabilistic Sharpe Ratio'',\n              ''Drawdown'', ''Win Rate'', ''Loss Rate'', ''Average Win'', ''Average Loss'',\n              ''Profit-Loss Ratio'', ''Expectancy'', ''Alpha'', ''Beta'',\n              ''Annual Standard Deviation'', ''Information Ratio'']:\n        print\\(f''  {k:<35} {s.get\\(k, \"\"?\"\"\\):>15}''\\)\n\n    print\\(f''  {\"\"Trades\"\":<35} {str\\(ts.get\\(\"\"totalNumberOfTrades\"\",\"\"?\"\"\\)\\):>15}''\\)\n    print\\(f''  {\"\"Fees\"\":<35} {r.get\\(\"\"Fees\"\",\"\"?\"\"\\):>15}''\\)\n    print\\(f''  {\"\"Equity\"\":<35} {r.get\\(\"\"Equity\"\",\"\"?\"\"\\):>15}''\\)\n    print\\(f''  {\"\"Return\"\":<35} {r.get\\(\"\"Return\"\",\"\"?\"\"\\):>15}''\\)\n    print\\(\\)\n\n# Compare to baseline\nprint\\(f''{''=''*70}''\\)\nprint\\(f''  BASELINE v4 \\(for comparison\\)''\\)\nprint\\(f''{''=''*70}''\\)\n\nbl = ''c:/ML/intra-trading-system-dynamic/results_from_quant_connect/event-driven new refactor/experiment_17_2_2026_1204/2016-2020''\njf = glob.glob\\(os.path.join\\(bl, ''*.json''\\)\\)\nif jf:\n    with open\\(jf[0], ''r''\\) as f:\n        data = json.load\\(f\\)\n    s = data.get\\(''statistics'', {}\\)\n    r = data.get\\(''runtimeStatistics'', {}\\)\n    for k in [''Compounding Annual Return'', ''Net Profit'', ''Sharpe Ratio'',\n              ''Sortino Ratio'', ''Probabilistic Sharpe Ratio'', ''Drawdown'',\n              ''Win Rate'', ''Alpha'', ''Beta'']:\n        print\\(f''  {k:<35} {s.get\\(k, \"\"?\"\"\\):>15}''\\)\n    print\\(f''  {\"\"Equity\"\":<35} {r.get\\(\"\"Equity\"\",\"\"?\"\"\\):>15}''\\)\n\")",
      "Bash(python3 -c \"\nimport json, os, glob, csv, sys, io\nfrom collections import defaultdict\nfrom datetime import datetime\nsys.stdout = io.TextIOWrapper\\(sys.stdout.buffer, encoding=''utf-8'', errors=''replace''\\)\n\nbase = ''c:/ML/intra-trading-system-dynamic/results_from_quant_connect/CombinedDualEngine/experiment_19_2_2026_1240''\nbase_bl = ''c:/ML/intra-trading-system-dynamic/results_from_quant_connect/event-driven new refactor/experiment_17_2_2026_1204''\n\nperiods = [''2016-2020'', ''2018-2021'', ''2020-2024'', ''2022-2023'']\n\nprint\\(''=''*95\\)\nprint\\(''FULL RESULTS: Monthly Rotator v1 vs Baseline v4''\\)\nprint\\(''=''*95\\)\nprint\\(\\)\nprint\\(f''{\"\"\"\":<30} {\"\"2016-2020\"\":>15} {\"\"2018-2021\"\":>15} {\"\"2020-2024\"\":>15} {\"\"2022-2023\"\":>15}''\\)\nprint\\(f''{\"\"\"\":<30} {\"\"-\"\"*15} {\"\"-\"\"*15} {\"\"-\"\"*15} {\"\"-\"\"*15}''\\)\n\nmetrics_to_show = [\n    ''Compounding Annual Return'', ''Net Profit'', ''Sharpe Ratio'', ''Sortino Ratio'',\n    ''Probabilistic Sharpe Ratio'', ''Drawdown'', ''Win Rate'',\n    ''Profit-Loss Ratio'', ''Expectancy'', ''Alpha'', ''Beta'', ''Annual Standard Deviation'',\n]\n\n# Collect all data\nall_data = {}\nfor label, base_dir in [\\(''Rotator'', base\\), \\(''Baseline'', base_bl\\)]:\n    all_data[label] = {}\n    for period in periods:\n        pp = os.path.join\\(base_dir, period\\)\n        if not os.path.isdir\\(pp\\):\n            continue\n        jf = glob.glob\\(os.path.join\\(pp, ''*.json''\\)\\)\n        if not jf:\n            continue\n        with open\\(jf[0], ''r''\\) as f:\n            data = json.load\\(f\\)\n        all_data[label][period] = data\n\n# Print rotator results\nprint\\(\\)\nprint\\(''MONTHLY ROTATOR v1:''\\)\nfor m in metrics_to_show:\n    vals = []\n    for p in periods:\n        d = all_data.get\\(''Rotator'', {}\\).get\\(p, {}\\)\n        v = d.get\\(''statistics'', {}\\).get\\(m, ''?''\\)\n        vals.append\\(v\\)\n    print\\(f''  {m:<30} {vals[0]:>15} {vals[1]:>15} {vals[2]:>15} {vals[3]:>15}''\\)\n\n# Extra stats\nfor p in periods:\n    d = all_data.get\\(''Rotator'', {}\\).get\\(p, {}\\)\n    ts = d.get\\(''totalPerformance'', {}\\).get\\(''tradeStatistics'', {}\\)\n    r = d.get\\(''runtimeStatistics'', {}\\)\n\nprint\\(\\)\nrow = []\nfor p in periods:\n    d = all_data.get\\(''Rotator'', {}\\).get\\(p, {}\\)\n    ts = d.get\\(''totalPerformance'', {}\\).get\\(''tradeStatistics'', {}\\)\n    row.append\\(str\\(ts.get\\(''totalNumberOfTrades'', ''?''\\)\\)\\)\nprint\\(f''  {\"\"Trades\"\":<30} {row[0]:>15} {row[1]:>15} {row[2]:>15} {row[3]:>15}''\\)\n\nrow = []\nfor p in periods:\n    d = all_data.get\\(''Rotator'', {}\\).get\\(p, {}\\)\n    r = d.get\\(''runtimeStatistics'', {}\\)\n    row.append\\(r.get\\(''Fees'', ''?''\\)\\)\nprint\\(f''  {\"\"Fees\"\":<30} {row[0]:>15} {row[1]:>15} {row[2]:>15} {row[3]:>15}''\\)\n\nrow = []\nfor p in periods:\n    d = all_data.get\\(''Rotator'', {}\\).get\\(p, {}\\)\n    r = d.get\\(''runtimeStatistics'', {}\\)\n    row.append\\(r.get\\(''Equity'', ''?''\\)\\)\nprint\\(f''  {\"\"Final Equity\"\":<30} {row[0]:>15} {row[1]:>15} {row[2]:>15} {row[3]:>15}''\\)\n\n# Print baseline\nprint\\(\\)\nprint\\(''BASELINE v4 \\(for comparison\\):''\\)\nfor m in [''Compounding Annual Return'', ''Net Profit'', ''Sharpe Ratio'', ''Probabilistic Sharpe Ratio'', ''Drawdown'', ''Alpha'', ''Beta'']:\n    vals = []\n    for p in periods:\n        d = all_data.get\\(''Baseline'', {}\\).get\\(p, {}\\)\n        v = d.get\\(''statistics'', {}\\).get\\(m, ''?''\\)\n        vals.append\\(v\\)\n    print\\(f''  {m:<30} {vals[0]:>15} {vals[1]:>15} {vals[2]:>15} {vals[3]:>15}''\\)\n\n# Delta summary\nprint\\(\\)\nprint\\(''DELTA \\(Rotator - Baseline\\):''\\)\nfor m, higher_good in [\\(''Compounding Annual Return'', True\\), \\(''Sharpe Ratio'', True\\), \n                        \\(''Probabilistic Sharpe Ratio'', True\\), \\(''Drawdown'', False\\)]:\n    deltas = []\n    for p in periods:\n        try:\n            rv = float\\(all_data[''Rotator''][p][''statistics''][m].replace\\(''%'',''''\\)\\)\n            bv = float\\(all_data[''Baseline''][p][''statistics''][m].replace\\(''%'',''''\\)\\)\n            d = rv - bv\n            tag = ''UP'' if \\(d > 0 and higher_good\\) or \\(d < 0 and not higher_good\\) else ''DOWN''\n            deltas.append\\(f''{d:+.2f} {tag}''\\)\n        except:\n            deltas.append\\(''?''\\)\n    print\\(f''  {m:<30} {deltas[0]:>15} {deltas[1]:>15} {deltas[2]:>15} {deltas[3]:>15}''\\)\n\")"
    ]
  }
}
